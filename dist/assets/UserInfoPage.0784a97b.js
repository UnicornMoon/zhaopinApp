import{d as U,r as A,o as T,c as L,a as u,l as y,b as a,e as p,F as S,m as N,i as W,E as $,T as i,g as l,p as M,h as P,_ as R}from"./index.b59b35ee.js";import{b as j,c as Y}from"./my.3f31c08e.js";import{t as q}from"./task.1fc562b9.js";import{m as z}from"./my.6306223f.js";const r=m=>(M("data-v-e40d7bae"),m=m(),P(),m),G={class:"user-page"},H={class:"user-pic"},J={class:"user-item"},K=r(()=>a("h5",null,"\u59D3\u540D",-1)),O={class:"user-item"},Q=r(()=>a("h5",null,"\u6027\u522B",-1)),X={class:"user-item"},Z=r(()=>a("h5",null,"\u51FA\u751F\u65E5\u671F",-1)),ee={class:"user-item"},te=r(()=>a("h5",null,"\u53C2\u52A0\u5DE5\u4F5C\u65F6\u95F4",-1)),oe={class:"user-item"},se=r(()=>a("h5",null,"\u6240\u5728\u57CE\u5E02",-1)),ue=r(()=>a("button",{class:"wy-confirm-btn","native-type":"submit"},"\u5B8C\u6210",-1)),ae=U({__name:"UserInfoPage",setup(m){const{closeChange:F}=N("popup"),n=z(),c=q();c.areaList.length||c.getCityList(),W().currentRoute.value.params.id;const e=A({fileList:[],showSex:!1,showBirthday:!1,showWorkTime:!1,showCity:!1,loading:!1,userName:"",sex:"",birthday:"",workTime:"",city:"",area:"",minDate:new Date(1970,1,1),maxDate:new Date}),C=[{name:"\u7537"},{name:"\u5973"}],_=()=>{e.userName=n.userInfo.user_name,e.sex=$.sex(n.userInfo.sex),e.birthday=n.userInfo.birthday,e.workTime=n.userInfo.work_time,e.city=n.userInfo.city,e.area=n.userInfo.area,n.userInfo.it_head&&(e.fileList=[{url:n.userInfo.it_head}])};n.userInfo.user_name?_():async function(){await n.getUserInfo(),_()}();const k=async s=>{s.status="uploading",s.message="\u4E0A\u4F20\u4E2D...";let t=new FormData;t.append("user","test"),t.append("file",s.file);const h=await j(t);s.url=h.imageUrl,s.status="done",s.message="\u4E0A\u4F20\u6210\u529F",e.fileList=[s]},v=s=>{e.birthday=s.getFullYear()+"-"+(s.getMonth()+1),e.showBirthday=!1},x=s=>{e.workTime=s.getFullYear()+"-"+(s.getMonth()+1),e.showWorkTime=!1},E=s=>{e.city=s[0].text,e.area=s[1].text,e.showCity=!1},g=()=>{e.fileList=[]},b=s=>{e.sex=s.name},B=async()=>{if(e.fileList.length===0){i("\u8BF7\u4E0A\u4F20\u5934\u50CF");return}if(!e.userName){i("\u8BF7\u586B\u5199\u59D3\u540D");return}if(!e.sex){i("\u8BF7\u9009\u62E9\u6027\u522B");return}if(!e.birthday){i("\u8BF7\u9009\u62E9\u51FA\u751F\u5E74\u6708");return}if(!e.workTime){i("\u8BF7\u9009\u62E9\u53C2\u52A0\u5DE5\u4F5C\u65F6\u95F4");return}if(!e.city){i("\u8BF7\u9009\u62E9\u57CE\u5E02");return}e.loading=!0;const s=await Y({user_name:e.userName,sex:e.sex==="\u7537"?1:e.sex==="\u5973"?2:"",birthday:e.birthday,work_time:e.workTime,city:e.city,area:e.area,it_head:e.fileList[0].url,type:1});s&&n.getUserInfo(),i(s.msg),e.loading=!1};return(s,t)=>{const h=l("van-nav-bar"),D=l("van-uploader"),d=l("van-field"),f=l("van-action-sheet"),w=l("van-datetime-picker"),I=l("van-picker"),V=l("van-form");return T(),L(S,null,[u(h,{title:"\u4E2A\u4EBA\u4FE1\u606F","left-arrow":"",onClickLeft:y(F)},null,8,["onClickLeft"]),a("div",G,[u(V,{onSubmit:B},{default:p(()=>[a("div",H,[u(D,{modelValue:e.fileList,"onUpdate:modelValue":t[0]||(t[0]=o=>e.fileList=o),accept:".jpg,.png","after-read":k,"before-delete":g,"max-count":"1"},null,8,["modelValue"])]),a("div",J,[K,u(d,{modelValue:e.userName,"onUpdate:modelValue":t[1]||(t[1]=o=>e.userName=o),label:"",placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u59D3\u540D"},null,8,["modelValue"])]),a("div",O,[Q,u(d,{modelValue:e.sex,"onUpdate:modelValue":t[2]||(t[2]=o=>e.sex=o),label:"",placeholder:"\u8BF7\u9009\u62E9\u60A8\u7684\u6027\u522B",readonly:"","is-link":"",onClick:t[3]||(t[3]=o=>e.showSex=!0)},null,8,["modelValue"]),u(f,{show:e.showSex,"onUpdate:show":t[4]||(t[4]=o=>e.showSex=o),actions:C,"cancel-text":"\u53D6\u6D88","close-on-click-action":"",onSelect:b},null,8,["show"])]),a("div",X,[Z,u(d,{modelValue:e.birthday,"onUpdate:modelValue":t[5]||(t[5]=o=>e.birthday=o),label:"",placeholder:"\u8BF7\u9009\u62E9\u60A8\u7684\u51FA\u751F\u65E5\u671F",readonly:"","is-link":"",onClick:t[6]||(t[6]=o=>e.showBirthday=!0)},null,8,["modelValue"]),u(f,{show:e.showBirthday,"onUpdate:show":t[7]||(t[7]=o=>e.showBirthday=o)},{default:p(()=>[u(w,{type:"year-month",title:"\u9009\u62E9\u5E74\u6708","min-date":e.minDate,"max-date":e.maxDate,onConfirm:v},null,8,["min-date","max-date"])]),_:1},8,["show"])]),a("div",ee,[te,u(d,{modelValue:e.workTime,"onUpdate:modelValue":t[8]||(t[8]=o=>e.workTime=o),label:"",placeholder:"\u8BF7\u9009\u62E9\u60A8\u7684\u5DE5\u4F5C\u65F6\u95F4",readonly:"","is-link":"",onClick:t[9]||(t[9]=o=>e.showWorkTime=!0)},null,8,["modelValue"]),u(f,{show:e.showWorkTime,"onUpdate:show":t[10]||(t[10]=o=>e.showWorkTime=o)},{default:p(()=>[u(w,{type:"year-month",title:"\u9009\u62E9\u5E74\u6708","min-date":e.minDate,"max-date":e.maxDate,onConfirm:x},null,8,["min-date","max-date"])]),_:1},8,["show"])]),a("div",oe,[se,u(d,{modelValue:e.city,"onUpdate:modelValue":t[11]||(t[11]=o=>e.city=o),label:"",placeholder:"\u8BF7\u9009\u62E9\u60A8\u7684\u57CE\u5E02",readonly:"","is-link":"",onClick:t[12]||(t[12]=o=>e.showCity=!0)},null,8,["modelValue"]),u(f,{show:e.showCity,"onUpdate:show":t[14]||(t[14]=o=>e.showCity=o)},{default:p(()=>[u(I,{columns:y(c).areaList,onConfirm:E,onCancel:t[13]||(t[13]=o=>e.showCity=!1)},null,8,["columns"])]),_:1},8,["show"])]),ue]),_:1})])],64)}}});const me=R(ae,[["__scopeId","data-v-e40d7bae"]]);export{me as U};
