import{d as b,o as c,j as z,e as y,c as _,k as $,b as e,l as f,F as m,m as E,T as M,g as h,_ as x,a as n,t as B,p as N,h as I,r as U,n as D,f as A,q,i as j,s as G}from"./index.b59b35ee.js";import{T as H}from"./TaskList.bd7a9774.js";import{F as J}from"./FooterTabbar.214a1f0b.js";import{b as K,s as O,t as Q}from"./task.59c7b2dc.js";import{t as F}from"./task.1fc562b9.js";import{P as W}from"./PositionType.e2a854d2.js";import"./request.9fb191dc.js";const X=["href"],Y=["src"],Z=["src"],tt=b({__name:"Banner",setup(i){E("popup");const u=F(),a=async()=>{const t=await K({type:2});t?u.setBannerList(t.list):M(t.msg)};return u.bannerList.length<=0&&a(),(t,k)=>{const g=h("van-swipe-item"),v=h("van-swipe");return c(),z(v,{autoplay:3e3,"lazy-render":""},{default:y(()=>[(c(!0),_(m,null,$(f(u).bannerList,(l,w)=>(c(),z(g,{key:w},{default:y(()=>[l.url?(c(),_("a",{key:0,href:l.url,target:"_blank"},[e("img",{src:l.picture},null,8,Y)],8,X)):(c(),_("img",{key:1,src:l.picture},null,8,Z))]),_:2},1024))),128))]),_:1})}}});const et=x(tt,[["__scopeId","data-v-c041269e"]]),P=i=>(N("data-v-f4ebbaf5"),i=i(),I(),i),st={class:"city-switch"},ot=P(()=>e("h3",null,"\u5F53\u524D\u57CE\u5E02\uFF1A",-1)),nt={class:"city-switch-text"},it=P(()=>e("h3",null,"\u5207\u6362\u57CE\u5E02\uFF1A",-1)),at={class:"city-switch-text"},ct=["onClick"],lt=b({__name:"CitySwitch",setup(i){const{closeCitySwitch:u}=E("popup"),a=F(),t=()=>u();return a.cityList.length<=0&&a.getCityList(),(k,g)=>{const v=h("van-nav-bar");return c(),_(m,null,[n(v,{title:"\u57CE\u5E02\u5207\u6362","left-arrow":"",onClickLeft:t}),e("div",st,[ot,e("div",nt,[e("span",null,B(f(a).cityValue),1)]),it,e("div",at,[(c(!0),_(m,null,$(f(a).cityList,(l,w)=>(c(),_("span",{key:w,onClick:p=>f(u)(l.name)},B(l.name),9,ct))),128))])])],64)}}});const _t=x(lt,[["__scopeId","data-v-f4ebbaf5"]]),R=i=>(N("data-v-62a3165b"),i=i(),I(),i),rt={class:"task-screen"},ut=R(()=>e("h3",null,"\u670D\u52A1\u65B9\u5F0F",-1)),pt={class:"screen-item"},dt=["onClick"],ht=R(()=>e("h3",null,"\u4EFB\u52A1\u5468\u671F",-1)),yt={class:"screen-item"},ft=["onClick"],vt={class:"screen-footer"},mt=A("\u786E\u5B9A"),kt=b({__name:"Screen",setup(i){const{closeScreen:u}=E("popup"),a=F(),t=U({mode:"",cycle:""}),k=()=>u(),g=p=>{t.mode=p},v=p=>{t.cycle=p},l=()=>{t.mode="",t.cycle=""},w=async()=>{const p=await O();p?a.setScreenList(p.data):M(p.msg)};return a.screenList.serviceMode||w(),(p,T)=>{const o=h("van-icon"),s=h("van-nav-bar"),V=h("van-button");return c(),_(m,null,[n(s,{title:"\u7B5B\u9009","left-arrow":"",onClickLeft:k},{left:y(()=>[n(o,{name:"cross",size:"18"})]),_:1}),e("div",rt,[ut,e("div",pt,[(c(!0),_(m,null,$(f(a).screenList.serviceMode,(d,C)=>(c(),_("span",{class:D(t.mode==d?"active":""),key:C,onClick:L=>g(d)},B(d),11,dt))),128))]),ht,e("div",yt,[(c(!0),_(m,null,$(f(a).screenList.taskCycle,(d,C)=>(c(),_("span",{class:D(t.cycle==d?"active":""),key:C,onClick:L=>v(d)},B(d),11,ft))),128))])]),e("div",vt,[e("button",{class:"screen-clear",onClick:l},"\u6E05\u9664"),n(V,{type:"primary",block:"",onClick:T[0]||(T[0]=d=>f(u)(t))},{default:y(()=>[mt]),_:1})])],64)}}});const gt=x(kt,[["__scopeId","data-v-62a3165b"]]),S=i=>(N("data-v-a314da7c"),i=i(),I(),i),wt={class:"task-page"},Bt={class:"task-top"},Ct=S(()=>e("i",null,null,-1)),Lt=S(()=>e("span",null,null,-1)),St={class:"task-title"},$t=S(()=>e("h3",null,"\u6700\u65B0\u4EFB\u52A1",-1)),bt=S(()=>e("span",null,null,-1)),xt=A("\u7B5B\u9009"),Ft=S(()=>e("span",null,null,-1)),Tt=[xt,Ft],Vt={key:0,class:"wy-no-data"},Et=b({__name:"index",setup(i){const u=j(),a=F(),t=U({citySwitchBool:!1,positionTypeBool:!1,screenBool:!1,positionValue:"",serviceMode:"",taskCycle:"",pageNum:0,pageSize:10,finished:!1,loading:!1,taskList:[]}),k=async()=>{t.loading=!0,t.pageNum==1&&(t.taskList=[]);const o=await Q({position_name:t.positionValue,service_mode:t.serviceMode,task_cycle:t.taskCycle,pageNum:t.pageNum,pageSize:t.pageSize,city:a.cityValue});o?(t.taskList=t.taskList.concat(o.records),t.loading=!1,t.taskList.length>=o.total?t.finished=!0:t.finished=!1):(Toast(o.msg),t.loading=!1)},g=()=>{u.push("/task/search")},v=()=>{t.pageNum=t.pageNum+1,k()},l=()=>{t.pageNum=1,k()};return G("popup",{closeCitySwitch:o=>{o&&(a.setCityValue(o),l()),t.citySwitchBool=!1},closePositionType:o=>{o&&(t.positionValue=o,l()),t.positionTypeBool=!1},closeScreen:o=>{o&&(t.serviceMode=o.mode,t.taskCycle=o.cycle,l()),t.screenBool=!1}}),(o,s)=>{const V=h("router-link"),d=h("van-list"),C=h("van-pull-refresh"),L=h("van-popup");return c(),_(m,null,[e("div",wt,[e("div",Bt,[e("div",{class:"task-top-city",onClick:s[0]||(s[0]=r=>t.citySwitchBool=!0)},[Ct,e("strong",null,B(f(a).cityValue),1),Lt]),e("input",{type:"text",onClick:g,readonly:"",placeholder:"\u8BF7\u8F93\u5165\u60F3\u8981\u641C\u7D20\u7684\u5185\u5BB9"}),n(V,{to:"/message/systemList",class:"task-icon-message"})]),n(et),e("div",St,[$t,e("div",{class:"task-positon-pop",onClick:s[1]||(s[1]=r=>t.positionTypeBool=!0)},[A(B(t.positionValue||"\u804C\u4F4D\u7C7B\u578B"),1),bt]),e("div",{class:"task-screen-pop",onClick:s[2]||(s[2]=r=>t.screenBool=!0)},Tt)]),n(C,{modelValue:t.loading,"onUpdate:modelValue":s[4]||(s[4]=r=>t.loading=r),onRefresh:l},{default:y(()=>[n(d,{loading:t.loading,"onUpdate:loading":s[3]||(s[3]=r=>t.loading=r),finished:t.finished,"finished-text":"",onLoad:v},{default:y(()=>[n(H,{taskList:t.taskList},null,8,["taskList"]),!t.loading&&t.taskList.length==0?(c(),_("div",Vt,"\u6682\u65E0\u6570\u636E")):q("",!0)]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"]),n(L,{show:t.citySwitchBool,"onUpdate:show":s[5]||(s[5]=r=>t.citySwitchBool=r),position:"top",duration:"0",style:{width:"100%",height:"100%"}},{default:y(()=>[n(_t)]),_:1},8,["show"]),n(L,{show:t.positionTypeBool,"onUpdate:show":s[6]||(s[6]=r=>t.positionTypeBool=r),position:"top",duration:"0",style:{width:"100%",height:"100%"}},{default:y(()=>[n(W)]),_:1},8,["show"]),n(L,{show:t.screenBool,"onUpdate:show":s[7]||(s[7]=r=>t.screenBool=r),position:"top",duration:"0",style:{width:"100%",height:"100%"}},{default:y(()=>[n(gt)]),_:1},8,["show"])]),n(J)],64)}}});const Pt=x(Et,[["__scopeId","data-v-a314da7c"]]);export{Pt as default};
